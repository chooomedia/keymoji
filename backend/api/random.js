// api/random.js - Vercel serverless function for emoji generation API
const fs = require('fs');
const path = require('path');

// Load emoji data
let emojisData;
try {
    const dataPath = path.join(process.cwd(), 'public', 'emojisArray.json');
    emojisData = JSON.parse(fs.readFileSync(dataPath, 'utf8'));
} catch (error) {
    // Fallback emoji array in case file can't be loaded
    emojisData = {
        emojis: [
            '😀',
            '😃',
            '😄',
            '😁',
            '😆',
            '😅',
            '🤣',
            '😂',
            '🙂',
            '🙃',
            '🫠',
            '😉',
            '😊',
            '😇',
            '🥰',
            '😍',
            '🤩',
            '😘',
            '😗',
            '☺',
            '😚',
            '😙',
            '🥲',
            '😋',
            '😛',
            '😜',
            '🤪',
            '😝',
            '🤑',
            '🤗',
            '🤭',
            '🫢',
            '🫣',
            '🤫',
            '🤔',
            '🫡',
            '🤐',
            '🤨',
            '😐',
            '😑',
            '😶',
            '🫥',
            '😶‍🌫️',
            '😏',
            '😒',
            '🙄',
            '😬',
            '😮‍💨',
            '🤥',
            '🫨',
            '🙂‍↔️',
            '🙂‍↕️',
            '😌',
            '😔',
            '😪',
            '🤤',
            '😴',
            '🫩',
            '😷',
            '🤒',
            '🤕',
            '🤢',
            '🤮',
            '🤧',
            '🥵',
            '🥶',
            '🥴',
            '😵',
            '😵‍💫',
            '🤯',
            '🤠',
            '🥳',
            '🥸',
            '😎',
            '🤓',
            '🧐',
            '😕',
            '🫤',
            '😟',
            '🙁',
            '☹',
            '😮',
            '😯',
            '😲',
            '😳',
            '🥺',
            '🥹',
            '😦',
            '😧',
            '😨',
            '😰',
            '😥',
            '😢',
            '😭',
            '😱',
            '😖',
            '😣',
            '😞',
            '😓',
            '😩',
            '😫',
            '🥱',
            '😤',
            '😡',
            '😠',
            '🤬',
            '😈',
            '👿',
            '💀',
            '☠',
            '💩',
            '🤡',
            '👹',
            '👺',
            '👻',
            '👽',
            '👾',
            '🤖',
            '😺',
            '😸',
            '😹',
            '😻',
            '😼',
            '😽',
            '🙀',
            '😿',
            '😾',
            '🙈',
            '🙉',
            '🙊',
            '💌',
            '💘',
            '💝',
            '💖',
            '💗',
            '💓',
            '💞',
            '💕',
            '💟',
            '❣',
            '💔',
            '❤️‍🔥',
            '❤️‍🩹',
            '❤',
            '🩷',
            '🧡',
            '💛',
            '💚',
            '💙',
            '🩵',
            '💜',
            '🤎',
            '🖤',
            '🩶',
            '🤍',
            '💋',
            '💯',
            '💢',
            '💥',
            '💫',
            '💦',
            '💨',
            '🕳',
            '💬',
            '👁️‍🗨️',
            '🗨',
            '🗯',
            '💭',
            '💤',
            '👋',
            '🤚',
            '🖐',
            '✋',
            '🖖',
            '🫱',
            '🫲',
            '🫳',
            '🫴',
            '🫷',
            '🫸',
            '👌',
            '🤌',
            '🤏',
            '✌',
            '🤞',
            '🫰',
            '🤟',
            '🤘',
            '🤙',
            '👈',
            '👉',
            '👆',
            '🖕',
            '👇',
            '☝',
            '🫵',
            '👍',
            '👎',
            '✊',
            '👊',
            '🤛',
            '🤜',
            '👏',
            '🙌',
            '🫶',
            '👐',
            '🤲',
            '🤝',
            '🙏',
            '✍',
            '💅',
            '🤳',
            '💪',
            '🦾',
            '🦿',
            '🦵',
            '🦶',
            '👂',
            '🦻',
            '👃',
            '🧠',
            '🫀',
            '🫁',
            '🦷',
            '🦴',
            '👀',
            '👁',
            '👅',
            '👄',
            '🫦',
            '👶',
            '🧒',
            '👦',
            '👧',
            '🧑',
            '👱',
            '👨',
            '🧔',
            '🧔‍♂️',
            '🧔‍♀️',
            '👨‍🦰',
            '👨‍🦱',
            '👨‍🦳',
            '👨‍🦲',
            '👩',
            '👩‍🦰',
            '🧑‍🦰',
            '👩‍🦱',
            '🧑‍🦱',
            '👩‍🦳',
            '🧑‍🦳',
            '👩‍🦲',
            '🧑‍🦲',
            '👱‍♀️',
            '👱‍♂️',
            '🧓',
            '👴',
            '👵',
            '🙍',
            '🙍‍♂️',
            '🙍‍♀️',
            '🙎',
            '🙎‍♂️',
            '🙎‍♀️',
            '🙅',
            '🙅‍♂️',
            '🙅‍♀️',
            '🙆',
            '🙆‍♂️',
            '🙆‍♀️',
            '💁',
            '💁‍♂️',
            '💁‍♀️',
            '🙋',
            '🙋‍♂️',
            '🙋‍♀️',
            '🧏',
            '🧏‍♂️',
            '🧏‍♀️',
            '🙇',
            '🙇‍♂️',
            '🙇‍♀️',
            '🤦',
            '🤦‍♂️',
            '🤦‍♀️',
            '🤷',
            '🤷‍♂️',
            '🤷‍♀️',
            '🧑‍⚕️',
            '👨‍⚕️',
            '👩‍⚕️',
            '🧑‍🎓',
            '👨‍🎓',
            '👩‍🎓',
            '🧑‍🏫',
            '👨‍🏫',
            '👩‍🏫',
            '🧑‍⚖️',
            '👨‍⚖️',
            '👩‍⚖️',
            '🧑‍🌾',
            '👨‍🌾',
            '👩‍🌾',
            '🧑‍🍳',
            '👨‍🍳',
            '👩‍🍳',
            '🧑‍🔧',
            '👨‍🔧',
            '👩‍🔧',
            '🧑‍🏭',
            '👨‍🏭',
            '👩‍🏭',
            '🧑‍💼',
            '👨‍💼',
            '👩‍💼',
            '🧑‍🔬',
            '👨‍🔬',
            '👩‍🔬',
            '🧑‍💻',
            '👨‍💻',
            '👩‍💻',
            '🧑‍🎤',
            '👨‍🎤',
            '👩‍🎤',
            '🧑‍🎨',
            '👨‍🎨',
            '👩‍🎨',
            '🧑‍✈️',
            '👨‍✈️',
            '👩‍✈️',
            '🧑‍🚀',
            '👨‍🚀',
            '👩‍🚀',
            '🧑‍🚒',
            '👨‍🚒',
            '👩‍🚒',
            '👮',
            '👮‍♂️',
            '👮‍♀️',
            '🕵',
            '🕵️‍♂️',
            '🕵️‍♀️',
            '💂',
            '💂‍♂️',
            '💂‍♀️',
            '🥷',
            '👷',
            '👷‍♂️',
            '👷‍♀️',
            '🫅',
            '🤴',
            '👸',
            '👳',
            '👳‍♂️',
            '👳‍♀️',
            '👲',
            '🧕',
            '🤵',
            '🤵‍♂️',
            '🤵‍♀️',
            '👰',
            '👰‍♂️',
            '👰‍♀️',
            '🤰',
            '🫃',
            '🫄',
            '🤱',
            '👩‍🍼',
            '👨‍🍼',
            '🧑‍🍼',
            '👼',
            '🎅',
            '🤶',
            '🧑‍🎄',
            '🦸',
            '🦸‍♂️',
            '🦸‍♀️',
            '🦹',
            '🦹‍♂️',
            '🦹‍♀️',
            '🧙',
            '🧙‍♂️',
            '🧙‍♀️',
            '🧚',
            '🧚‍♂️',
            '🧚‍♀️',
            '🧛',
            '🧛‍♂️',
            '🧛‍♀️',
            '🧜',
            '🧜‍♂️',
            '🧜‍♀️',
            '🧝',
            '🧝‍♂️',
            '🧝‍♀️',
            '🧞',
            '🧞‍♂️',
            '🧞‍♀️',
            '🧟',
            '🧟‍♂️',
            '🧟‍♀️',
            '🧌',
            '💆',
            '💆‍♂️',
            '💆‍♀️',
            '💇',
            '💇‍♂️',
            '💇‍♀️',
            '🚶',
            '🚶‍♂️',
            '🚶‍♀️',
            '🚶‍➡️',
            '🚶‍♀️‍➡️',
            '🚶‍♂️‍➡️',
            '🧍',
            '🧍‍♂️',
            '🧍‍♀️',
            '🧎',
            '🧎‍♂️',
            '🧎‍♀️',
            '🧎‍➡️',
            '🧎‍♀️‍➡️',
            '🧎‍♂️‍➡️',
            '🧑‍🦯',
            '🧑‍🦯‍➡️',
            '👨‍🦯',
            '👨‍🦯‍➡️',
            '👩‍🦯',
            '👩‍🦯‍➡️',
            '🧑‍🦼',
            '🧑‍🦼‍➡️',
            '👨‍🦼',
            '👨‍🦼‍➡️',
            '👩‍🦼',
            '👩‍🦼‍➡️',
            '🧑‍🦽',
            '🧑‍🦽‍➡️',
            '👨‍🦽',
            '👨‍🦽‍➡️',
            '👩‍🦽',
            '👩‍🦽‍➡️',
            '🏃',
            '🏃‍♂️',
            '🏃‍♀️',
            '🏃‍➡️',
            '🏃‍♀️‍➡️',
            '🏃‍♂️‍➡️',
            '💃',
            '🕺',
            '🕴',
            '👯',
            '👯‍♂️',
            '👯‍♀️',
            '🧖',
            '🧖‍♂️',
            '🧖‍♀️',
            '🧗',
            '🧗‍♂️',
            '🧗‍♀️',
            '🤺',
            '🏇',
            '⛷',
            '🏂',
            '🏌',
            '🏌️‍♂️',
            '🏌️‍♀️',
            '🏄',
            '🏄‍♂️',
            '🏄‍♀️',
            '🚣',
            '🚣‍♂️',
            '🚣‍♀️',
            '🏊',
            '🏊‍♂️',
            '🏊‍♀️',
            '⛹',
            '⛹️‍♂️',
            '⛹️‍♀️',
            '🏋',
            '🏋️‍♂️',
            '🏋️‍♀️',
            '🚴',
            '🚴‍♂️',
            '🚴‍♀️',
            '🚵',
            '🚵‍♂️',
            '🚵‍♀️',
            '🤸',
            '🤸‍♂️',
            '🤸‍♀️',
            '🤼',
            '🤼‍♂️',
            '🤼‍♀️',
            '🤽',
            '🤽‍♂️',
            '🤽‍♀️',
            '🤾',
            '🤾‍♂️',
            '🤾‍♀️',
            '🤹',
            '🤹‍♂️',
            '🤹‍♀️',
            '🧘',
            '🧘‍♂️',
            '🧘‍♀️',
            '🛀',
            '🛌',
            '🧑‍🤝‍🧑',
            '👭',
            '👫',
            '👬',
            '💏',
            '👩‍❤️‍💋‍👨',
            '👨‍❤️‍💋‍👨',
            '👩‍❤️‍💋‍👩',
            '💑',
            '👩‍❤️‍👨',
            '👨‍❤️‍👨',
            '👩‍❤️‍👩',
            '👨‍👩‍👦',
            '👨‍👩‍👧',
            '👨‍👩‍👧‍👦',
            '👨‍👩‍👦‍👦',
            '👨‍👩‍👧‍👧',
            '👨‍👨‍👦',
            '👨‍👨‍👧',
            '👨‍👨‍👧‍👦',
            '👨‍👨‍👦‍👦',
            '👨‍👨‍👧‍👧',
            '👩‍👩‍👦',
            '👩‍👩‍👧',
            '👩‍👩‍👧‍👦',
            '👩‍👩‍👦‍👦',
            '👩‍👩‍👧‍👧',
            '👨‍👦',
            '👨‍👦‍👦',
            '👨‍👧',
            '👨‍👧‍👦',
            '👨‍👧‍👧',
            '👩‍👦',
            '👩‍👦‍👦',
            '👩‍👧',
            '👩‍👧‍👦',
            '👩‍👧‍👧',
            '🗣',
            '👤',
            '👥',
            '🫂',
            '👪',
            '🧑‍🧑‍🧒',
            '🧑‍🧑‍🧒‍🧒',
            '🧑‍🧒',
            '🧑‍🧒‍🧒',
            '👣',
            '🫆',
            '🦰',
            '🦱',
            '🦳',
            '🦲',
            '🐵',
            '🐒',
            '🦍',
            '🦧',
            '🐶',
            '🐕',
            '🦮',
            '🐕‍🦺',
            '🐩',
            '🐺',
            '🦊',
            '🦝',
            '🐱',
            '🐈',
            '🐈‍⬛',
            '🦁',
            '🐯',
            '🐅',
            '🐆',
            '🐴',
            '🫎',
            '🫏',
            '🐎',
            '🦄',
            '🦓',
            '🦌',
            '🦬',
            '🐮',
            '🐂',
            '🐃',
            '🐄',
            '🐷',
            '🐖',
            '🐗',
            '🐽',
            '🐏',
            '🐑',
            '🐐',
            '🐪',
            '🐫',
            '🦙',
            '🦒',
            '🐘',
            '🦣',
            '🦏',
            '🦛',
            '🐭',
            '🐁',
            '🐀',
            '🐹',
            '🐰',
            '🐇',
            '🐿',
            '🦫',
            '🦔',
            '🦇',
            '🐻',
            '🐻‍❄️',
            '🐨',
            '🐼',
            '🦥',
            '🦦',
            '🦨',
            '🦘',
            '🦡',
            '🐾',
            '🦃',
            '🐔',
            '🐓',
            '🐣',
            '🐤',
            '🐥',
            '🐦',
            '🐧',
            '🕊',
            '🦅',
            '🦆',
            '🦢',
            '🦉',
            '🦤',
            '🪶',
            '🦩',
            '🦚',
            '🦜',
            '🪽',
            '🐦‍⬛',
            '🪿',
            '🐦‍🔥',
            '🐸',
            '🐊',
            '🐢',
            '🦎',
            '🐍',
            '🐲',
            '🐉',
            '🦕',
            '🦖',
            '🐳',
            '🐋',
            '🐬',
            '🦭',
            '🐟',
            '🐠',
            '🐡',
            '🦈',
            '🐙',
            '🐚',
            '🪸',
            '🪼',
            '🦀',
            '🦞',
            '🦐',
            '🦑',
            '🦪',
            '🐌',
            '🦋',
            '🐛',
            '🐜',
            '🐝',
            '🪲',
            '🐞',
            '🦗',
            '🪳',
            '🕷',
            '🕸',
            '🦂',
            '🦟',
            '🪰',
            '🪱',
            '🦠',
            '💐',
            '🌸',
            '💮',
            '🪷',
            '🏵',
            '🌹',
            '🥀',
            '🌺',
            '🌻',
            '🌼',
            '🌷',
            '🪻',
            '🌱',
            '🪴',
            '🌲',
            '🌳',
            '🌴',
            '🌵',
            '🌾',
            '🌿',
            '☘',
            '🍀',
            '🍁',
            '🍂',
            '🍃',
            '🪹',
            '🪺',
            '🍄',
            '🪾',
            '🍇',
            '🍈',
            '🍉',
            '🍊',
            '🍋',
            '🍋‍🟩',
            '🍌',
            '🍍',
            '🥭',
            '🍎',
            '🍏',
            '🍐',
            '🍑',
            '🍒',
            '🍓',
            '🫐',
            '🥝',
            '🍅',
            '🫒',
            '🥥',
            '🥑',
            '🍆',
            '🥔',
            '🥕',
            '🌽',
            '🌶',
            '🫑',
            '🥒',
            '🥬',
            '🥦',
            '🧄',
            '🧅',
            '🥜',
            '🫘',
            '🌰',
            '🫚',
            '🫛',
            '🍄‍🟫',
            '🫜',
            '🍞',
            '🥐',
            '🥖',
            '🫓',
            '🥨',
            '🥯',
            '🥞',
            '🧇',
            '🧀',
            '🍖',
            '🍗',
            '🥩',
            '🥓',
            '🍔',
            '🍟',
            '🍕',
            '🌭',
            '🥪',
            '🌮',
            '🌯',
            '🫔',
            '🥙',
            '🧆',
            '🥚',
            '🍳',
            '🥘',
            '🍲',
            '🫕',
            '🥣',
            '🥗',
            '🍿',
            '🧈',
            '🧂',
            '🥫',
            '🍱',
            '🍘',
            '🍙',
            '🍚',
            '🍛',
            '🍜',
            '🍝',
            '🍠',
            '🍢',
            '🍣',
            '🍤',
            '🍥',
            '🥮',
            '🍡',
            '🥟',
            '🥠',
            '🥡',
            '🍦',
            '🍧',
            '🍨',
            '🍩',
            '🍪',
            '🎂',
            '🍰',
            '🧁',
            '🥧',
            '🍫',
            '🍬',
            '🍭',
            '🍮',
            '🍯',
            '🍼',
            '🥛',
            '☕',
            '🫖',
            '🍵',
            '🍶',
            '🍾',
            '🍷',
            '🍸',
            '🍹',
            '🍺',
            '🍻',
            '🥂',
            '🥃',
            '🫗',
            '🥤',
            '🧋',
            '🧃',
            '🧉',
            '🧊',
            '🥢',
            '🍽',
            '🍴',
            '🥄',
            '🔪',
            '🫙',
            '🏺',
            '🌍',
            '🌎',
            '🌏',
            '🌐',
            '🗺',
            '🗾',
            '🧭',
            '🏔',
            '⛰',
            '🌋',
            '🗻',
            '🏕',
            '🏖',
            '🏜',
            '🏝',
            '🏞',
            '🏟',
            '🏛',
            '🏗',
            '🧱',
            '🪨',
            '🪵',
            '🛖',
            '🏘',
            '🏚',
            '🏠',
            '🏡',
            '🏢',
            '🏣',
            '🏤',
            '🏥',
            '🏦',
            '🏨',
            '🏩',
            '🏪',
            '🏫',
            '🏬',
            '🏭',
            '🏯',
            '🏰',
            '💒',
            '🗼',
            '🗽',
            '⛪',
            '🕌',
            '🛕',
            '🕍',
            '⛩',
            '🕋',
            '⛲',
            '⛺',
            '🌁',
            '🌃',
            '🏙',
            '🌄',
            '🌅',
            '🌆',
            '🌇',
            '🌉',
            '♨',
            '🎠',
            '🛝',
            '🎡',
            '🎢',
            '💈',
            '🎪',
            '🚂',
            '🚃',
            '🚄',
            '🚅',
            '🚆',
            '🚇',
            '🚈',
            '🚉',
            '🚊',
            '🚝',
            '🚞',
            '🚋',
            '🚌',
            '🚍',
            '🚎',
            '🚐',
            '🚑',
            '🚒',
            '🚓',
            '🚔',
            '🚕',
            '🚖',
            '🚗',
            '🚘',
            '🚙',
            '🛻',
            '🚚',
            '🚛',
            '🚜',
            '🏎',
            '🏍',
            '🛵',
            '🦽',
            '🦼',
            '🛺',
            '🚲',
            '🛴',
            '🛹',
            '🛼',
            '🚏',
            '🛣',
            '🛤',
            '🛢',
            '⛽',
            '🛞',
            '🚨',
            '🚥',
            '🚦',
            '🛑',
            '🚧',
            '⚓',
            '🛟',
            '⛵',
            '🛶',
            '🚤',
            '🛳',
            '⛴',
            '🛥',
            '🚢',
            '✈',
            '🛩',
            '🛫',
            '🛬',
            '🪂',
            '💺',
            '🚁',
            '🚟',
            '🚠',
            '🚡',
            '🛰',
            '🚀',
            '🛸',
            '🛎',
            '🧳',
            '⌛',
            '⏳',
            '⌚',
            '⏰',
            '⏱',
            '⏲',
            '🕰',
            '🕛',
            '🕧',
            '🕐',
            '🕜',
            '🕑',
            '🕝',
            '🕒',
            '🕞',
            '🕓',
            '🕟',
            '🕔',
            '🕠',
            '🕕',
            '🕡',
            '🕖',
            '🕢',
            '🕗',
            '🕣',
            '🕘',
            '🕤',
            '🕙',
            '🕥',
            '🕚',
            '🕦',
            '🌑',
            '🌒',
            '🌓',
            '🌔',
            '🌕',
            '🌖',
            '🌗',
            '🌘',
            '🌙',
            '🌚',
            '🌛',
            '🌜',
            '🌡',
            '☀',
            '🌝',
            '🌞',
            '🪐',
            '⭐',
            '🌟',
            '🌠',
            '🌌',
            '☁',
            '⛅',
            '⛈',
            '🌤',
            '🌥',
            '🌦',
            '🌧',
            '🌨',
            '🌩',
            '🌪',
            '🌫',
            '🌬',
            '🌀',
            '🌈',
            '🌂',
            '☂',
            '☔',
            '⛱',
            '⚡',
            '❄',
            '☃',
            '⛄',
            '☄',
            '🔥',
            '💧',
            '🌊',
            '🎃',
            '🎄',
            '🎆',
            '🎇',
            '🧨',
            '✨',
            '🎈',
            '🎉',
            '🎊',
            '🎋',
            '🎍',
            '🎎',
            '🎏',
            '🎐',
            '🎑',
            '🧧',
            '🎀',
            '🎁',
            '🎗',
            '🎟',
            '🎫',
            '🎖',
            '🏆',
            '🏅',
            '🥇',
            '🥈',
            '🥉',
            '⚽',
            '⚾',
            '🥎',
            '🏀',
            '🏐',
            '🏈',
            '🏉',
            '🎾',
            '🥏',
            '🎳',
            '🏏',
            '🏑',
            '🏒',
            '🥍',
            '🏓',
            '🏸',
            '🥊',
            '🥋',
            '🥅',
            '⛳',
            '⛸',
            '🎣',
            '🤿',
            '🎽',
            '🎿',
            '🛷',
            '🥌',
            '🎯',
            '🪀',
            '🪁',
            '🔫',
            '🎱',
            '🔮',
            '🪄',
            '🎮',
            '🕹',
            '🎰',
            '🎲',
            '🧩',
            '🧸',
            '🪅',
            '🪩',
            '🪆',
            '♠',
            '♥',
            '♦',
            '♣',
            '♟',
            '🃏',
            '🀄',
            '🎴',
            '🎭',
            '🖼',
            '🎨',
            '🧵',
            '🪡',
            '🧶',
            '🪢',
            '👓',
            '🕶',
            '🥽',
            '🥼',
            '🦺',
            '👔',
            '👕',
            '👖',
            '🧣',
            '🧤',
            '🧥',
            '🧦',
            '👗',
            '👘',
            '🥻',
            '🩱',
            '🩲',
            '🩳',
            '👙',
            '👚',
            '🪭',
            '👛',
            '👜',
            '👝',
            '🛍',
            '🎒',
            '🩴',
            '👞',
            '👟',
            '🥾',
            '🥿',
            '👠',
            '👡',
            '🩰',
            '👢',
            '🪮',
            '👑',
            '👒',
            '🎩',
            '🎓',
            '🧢',
            '🪖',
            '⛑',
            '📿',
            '💄',
            '💍',
            '💎',
            '🔇',
            '🔈',
            '🔉',
            '🔊',
            '📢',
            '📣',
            '📯',
            '🔔',
            '🔕',
            '🎼',
            '🎵',
            '🎶',
            '🎙',
            '🎚',
            '🎛',
            '🎤',
            '🎧',
            '📻',
            '🎷',
            '🪗',
            '🎸',
            '🎹',
            '🎺',
            '🎻',
            '🪕',
            '🥁',
            '🪘',
            '🪇',
            '🪈',
            '🪉',
            '📱',
            '📲',
            '☎',
            '📞',
            '📟',
            '📠',
            '🔋',
            '🪫',
            '🔌',
            '💻',
            '🖥',
            '🖨',
            '⌨',
            '🖱',
            '🖲',
            '💽',
            '💾',
            '💿',
            '📀',
            '🧮',
            '🎥',
            '🎞',
            '📽',
            '🎬',
            '📺',
            '📷',
            '📸',
            '📹',
            '📼',
            '🔍',
            '🔎',
            '🕯',
            '💡',
            '🔦',
            '🏮',
            '🪔',
            '📔',
            '📕',
            '📖',
            '📗',
            '📘',
            '📙',
            '📚',
            '📓',
            '📒',
            '📃',
            '📜',
            '📄',
            '📰',
            '🗞',
            '📑',
            '🔖',
            '🏷',
            '💰',
            '🪙',
            '💴',
            '💵',
            '💶',
            '💷',
            '💸',
            '💳',
            '🧾',
            '💹',
            '✉',
            '📧',
            '📨',
            '📩',
            '📤',
            '📥',
            '📦',
            '📫',
            '📪',
            '📬',
            '📭',
            '📮',
            '🗳',
            '✏',
            '✒',
            '🖋',
            '🖊',
            '🖌',
            '🖍',
            '📝',
            '💼',
            '📁',
            '📂',
            '🗂',
            '📅',
            '📆',
            '🗒',
            '🗓',
            '📇',
            '📈',
            '📉',
            '📊',
            '📋',
            '📌',
            '📍',
            '📎',
            '🖇',
            '📏',
            '📐',
            '✂',
            '🗃',
            '🗄',
            '🗑',
            '🔒',
            '🔓',
            '🔏',
            '🔐',
            '🔑',
            '🗝',
            '🔨',
            '🪓',
            '⛏',
            '⚒',
            '🛠',
            '🗡',
            '⚔',
            '💣',
            '🪃',
            '🏹',
            '🛡',
            '🪚',
            '🔧',
            '🪛',
            '🔩',
            '⚙',
            '🗜',
            '⚖',
            '🦯',
            '🔗',
            '⛓️‍💥',
            '⛓',
            '🪝',
            '🧰',
            '🧲',
            '🪜',
            '🪏',
            '⚗',
            '🧪',
            '🧫',
            '🧬',
            '🔬',
            '🔭',
            '📡',
            '💉',
            '🩸',
            '💊',
            '🩹',
            '🩼',
            '🩺',
            '🩻',
            '🚪',
            '🛗',
            '🪞',
            '🪟',
            '🛏',
            '🛋',
            '🪑',
            '🚽',
            '🪠',
            '🚿',
            '🛁',
            '🪤',
            '🪒',
            '🧴',
            '🧷',
            '🧹',
            '🧺',
            '🧻',
            '🪣',
            '🧼',
            '🫧',
            '🪥',
            '🧽',
            '🧯',
            '🛒',
            '🚬',
            '⚰',
            '🪦',
            '⚱',
            '🧿',
            '🪬',
            '🗿',
            '🪧',
            '🪪',
            '🏧',
            '🚮',
            '🚰',
            '♿',
            '🚹',
            '🚺',
            '🚻',
            '🚼',
            '🚾',
            '🛂',
            '🛃',
            '🛄',
            '🛅',
            '⚠',
            '🚸',
            '⛔',
            '🚫',
            '🚳',
            '🚭',
            '🚯',
            '🚱',
            '🚷',
            '📵',
            '🔞',
            '☢',
            '☣',
            '⬆',
            '↗',
            '➡',
            '↘',
            '⬇',
            '↙',
            '⬅',
            '↖',
            '↕',
            '↔',
            '↩',
            '↪',
            '⤴',
            '⤵',
            '🔃',
            '🔄',
            '🔙',
            '🔚',
            '🔛',
            '🔜',
            '🔝',
            '🛐',
            '⚛',
            '🕉',
            '✡',
            '☸',
            '☯',
            '✝',
            '☦',
            '☪',
            '☮',
            '🕎',
            '🔯',
            '🪯',
            '♈',
            '♉',
            '♊',
            '♋',
            '♌',
            '♍',
            '♎',
            '♏',
            '♐',
            '♑',
            '♒',
            '♓',
            '⛎',
            '🔀',
            '🔁',
            '🔂',
            '▶',
            '⏩',
            '⏭',
            '⏯',
            '◀',
            '⏪',
            '⏮',
            '🔼',
            '⏫',
            '🔽',
            '⏬',
            '⏸',
            '⏹',
            '⏺',
            '⏏',
            '🎦',
            '🔅',
            '🔆',
            '📶',
            '🛜',
            '📳',
            '📴',
            '♀',
            '♂',
            '⚧',
            '✖',
            '➕',
            '➖',
            '➗',
            '🟰',
            '♾',
            '‼',
            '⁉',
            '❓',
            '❔',
            '❕',
            '❗',
            '〰',
            '💱',
            '💲',
            '⚕',
            '♻',
            '⚜',
            '🔱',
            '📛',
            '🔰',
            '⭕',
            '✅',
            '☑',
            '✔',
            '❌',
            '❎',
            '➰',
            '➿',
            '〽',
            '✳',
            '✴',
            '❇',
            '©',
            '®',
            '™',
            '🫟',
            '#️⃣',
            '*️⃣',
            '0️⃣',
            '1️⃣',
            '2️⃣',
            '3️⃣',
            '4️⃣',
            '5️⃣',
            '6️⃣',
            '7️⃣',
            '8️⃣',
            '9️⃣',
            '🔟',
            '🔠',
            '🔡',
            '🔢',
            '🔣',
            '🔤',
            '🅰',
            '🆎',
            '🅱',
            '🆑',
            '🆒',
            '🆓',
            'ℹ',
            '🆔',
            'Ⓜ',
            '🆕',
            '🆖',
            '🅾',
            '🆗',
            '🅿',
            '🆘',
            '🆙',
            '🆚',
            '🈁',
            '🈂',
            '🈷',
            '🈶',
            '🈯',
            '🉐',
            '🈹',
            '🈚',
            '🈲',
            '🉑',
            '🈸',
            '🈴',
            '🈳',
            '㊗',
            '㊙',
            '🈺',
            '🈵',
            '🔴',
            '🟠',
            '🟡',
            '🟢',
            '🔵',
            '🟣',
            '🟤',
            '⚫',
            '⚪',
            '🟥',
            '🟧',
            '🟨',
            '🟩',
            '🟦',
            '🟪',
            '🟫',
            '⬛',
            '⬜',
            '◼',
            '◻',
            '◾',
            '◽',
            '▪',
            '▫',
            '🔶',
            '🔷',
            '🔸',
            '🔹',
            '🔺',
            '🔻',
            '💠',
            '🔘',
            '🔳',
            '🔲',
            '🏁',
            '🚩',
            '🎌',
            '🏴',
            '🏳',
            '🏳️‍🌈',
            '🏳️‍⚧️',
            '🏴‍☠️',
            '🇦🇨',
            '🇦🇩',
            '🇦🇪',
            '🇦🇫',
            '🇦🇬',
            '🇦🇮',
            '🇦🇱',
            '🇦🇲',
            '🇦🇴',
            '🇦🇶',
            '🇦🇷',
            '🇦🇸',
            '🇦🇹',
            '🇦🇺',
            '🇦🇼',
            '🇦🇽',
            '🇦🇿',
            '🇧🇦',
            '🇧🇧',
            '🇧🇩',
            '🇧🇪',
            '🇧🇫',
            '🇧🇬',
            '🇧🇭',
            '🇧🇮',
            '🇧🇯',
            '🇧🇱',
            '🇧🇲',
            '🇧🇳',
            '🇧🇴',
            '🇧🇶',
            '🇧🇷',
            '🇧🇸',
            '🇧🇹',
            '🇧🇻',
            '🇧🇼',
            '🇧🇾',
            '🇧🇿',
            '🇨🇦',
            '🇨🇨',
            '🇨🇩',
            '🇨🇫',
            '🇨🇬',
            '🇨🇭',
            '🇨🇮',
            '🇨🇰',
            '🇨🇱',
            '🇨🇲',
            '🇨🇳',
            '🇨🇴',
            '🇨🇵',
            '🇨🇶',
            '🇨🇷',
            '🇨🇺',
            '🇨🇻',
            '🇨🇼',
            '🇨🇽',
            '🇨🇾',
            '🇨🇿',
            '🇩🇪',
            '🇩🇬',
            '🇩🇯',
            '🇩🇰',
            '🇩🇲',
            '🇩🇴',
            '🇩🇿',
            '🇪🇦',
            '🇪🇨',
            '🇪🇪',
            '🇪🇬',
            '🇪🇭',
            '🇪🇷',
            '🇪🇸',
            '🇪🇹',
            '🇪🇺',
            '🇫🇮',
            '🇫🇯',
            '🇫🇰',
            '🇫🇲',
            '🇫🇴',
            '🇫🇷',
            '🇬🇦',
            '🇬🇧',
            '🇬🇩',
            '🇬🇪',
            '🇬🇫',
            '🇬🇬',
            '🇬🇭',
            '🇬🇮',
            '🇬🇱',
            '🇬🇲',
            '🇬🇳',
            '🇬🇵',
            '🇬🇶',
            '🇬🇷',
            '🇬🇸',
            '🇬🇹',
            '🇬🇺',
            '🇬🇼',
            '🇬🇾',
            '🇭🇰',
            '🇭🇲',
            '🇭🇳',
            '🇭🇷',
            '🇭🇹',
            '🇭🇺',
            '🇮🇨',
            '🇮🇩',
            '🇮🇪',
            '🇮🇱',
            '🇮🇲',
            '🇮🇳',
            '🇮🇴',
            '🇮🇶',
            '🇮🇷',
            '🇮🇸',
            '🇮🇹',
            '🇯🇪',
            '🇯🇲',
            '🇯🇴',
            '🇯🇵',
            '🇰🇪',
            '🇰🇬',
            '🇰🇭',
            '🇰🇮',
            '🇰🇲',
            '🇰🇳',
            '🇰🇵',
            '🇰🇷',
            '🇰🇼',
            '🇰🇾',
            '🇰🇿',
            '🇱🇦',
            '🇱🇧',
            '🇱🇨',
            '🇱🇮',
            '🇱🇰',
            '🇱🇷',
            '🇱🇸',
            '🇱🇹',
            '🇱🇺',
            '🇱🇻',
            '🇱🇾',
            '🇲🇦',
            '🇲🇨',
            '🇲🇩',
            '🇲🇪',
            '🇲🇫',
            '🇲🇬',
            '🇲🇭',
            '🇲🇰',
            '🇲🇱',
            '🇲🇲',
            '🇲🇳',
            '🇲🇴',
            '🇲🇵',
            '🇲🇶',
            '🇲🇷',
            '🇲🇸',
            '🇲🇹',
            '🇲🇺',
            '🇲🇻',
            '🇲🇼',
            '🇲🇽',
            '🇲🇾',
            '🇲🇿',
            '🇳🇦',
            '🇳🇨',
            '🇳🇪',
            '🇳🇫',
            '🇳🇬',
            '🇳🇮',
            '🇳🇱',
            '🇳🇴',
            '🇳🇵',
            '🇳🇷',
            '🇳🇺',
            '🇳🇿',
            '🇴🇲',
            '🇵🇦',
            '🇵🇪',
            '🇵🇫',
            '🇵🇬',
            '🇵🇭',
            '🇵🇰',
            '🇵🇱',
            '🇵🇲',
            '🇵🇳',
            '🇵🇷',
            '🇵🇸',
            '🇵🇹',
            '🇵🇼',
            '🇵🇾',
            '🇶🇦',
            '🇷🇪',
            '🇷🇴',
            '🇷🇸',
            '🇷🇺',
            '🇷🇼',
            '🇸🇦',
            '🇸🇧',
            '🇸🇨',
            '🇸🇩',
            '🇸🇪',
            '🇸🇬',
            '🇸🇭',
            '🇸🇮',
            '🇸🇯',
            '🇸🇰',
            '🇸🇱',
            '🇸🇲',
            '🇸🇳',
            '🇸🇴',
            '🇸🇷',
            '🇸🇸',
            '🇸🇹',
            '🇸🇻',
            '🇸🇽',
            '🇸🇾',
            '🇸🇿',
            '🇹🇦',
            '🇹🇨',
            '🇹🇩',
            '🇹🇫',
            '🇹🇬',
            '🇹🇭',
            '🇹🇯',
            '🇹🇰',
            '🇹🇱',
            '🇹🇲',
            '🇹🇳',
            '🇹🇴',
            '🇹🇷',
            '🇹🇹',
            '🇹🇻',
            '🇹🇼',
            '🇹🇿',
            '🇺🇦',
            '🇺🇬',
            '🇺🇲',
            '🇺🇳',
            '🇺🇸',
            '🇺🇾',
            '🇺🇿',
            '🇻🇦',
            '🇻🇨',
            '🇻🇪',
            '🇻🇬',
            '🇻🇮',
            '🇻🇳',
            '🇻🇺',
            '🇼🇫',
            '🇼🇸',
            '🇽🇰',
            '🇾🇪',
            '🇾🇹',
            '🇿🇦',
            '🇿🇲',
            '🇿🇼',
            '🏴󠁧󠁢󠁥󠁮󠁧󠁿',
            '🏴󠁧󠁢󠁳󠁣󠁴󠁿',
            '🏴󠁧󠁢󠁷󠁬󠁳󠁿'
        ]
    };
}

// Constants for API
const API_MIN_COUNT = 5;
const API_MAX_COUNT = 9;
const RATE_LIMIT_MS = 10000; // 10 seconds

// Memory store for rate limiting (will reset on function cold start)
const rateLimits = new Map();

// Utility function to get random emojis
function getRandomEmojis(count, emojis) {
    if (!emojis || !Array.isArray(emojis) || emojis.length === 0) {
        return [];
    }

    return [...emojis].sort(() => Math.random() - 0.5).slice(0, count);
}

export default function handler(req, res) {
    // Set CORS headers
    res.setHeader('Access-Control-Allow-Origin', '*');
    res.setHeader('Access-Control-Allow-Methods', 'GET, OPTIONS');
    res.setHeader('Access-Control-Allow-Headers', 'Content-Type');

    // Handle preflight requests
    if (req.method === 'OPTIONS') {
        res.status(200).end();
        return;
    }

    // Only allow GET requests
    if (req.method !== 'GET') {
        return res.status(405).json({
            error: 'Method not allowed',
            timestamp: new Date().toISOString()
        });
    }

    // Extract count parameter from URL
    const countParam = req.query.count;

    if (!countParam) {
        return res.status(400).json({
            error: 'Missing parameter: count',
            timestamp: new Date().toISOString()
        });
    }

    // Validate parameter
    const count = parseInt(countParam, 10);

    if (isNaN(count)) {
        return res.status(400).json({
            error: 'Invalid parameter: count must be a number',
            timestamp: new Date().toISOString()
        });
    }

    // Validate range
    if (count < API_MIN_COUNT || count > API_MAX_COUNT) {
        return res.status(400).json({
            error: `Invalid parameter: count must be between ${API_MIN_COUNT} and ${API_MAX_COUNT}`,
            timestamp: new Date().toISOString()
        });
    }

    // Rate limiting - using IP or a custom header
    const clientId =
        req.headers['x-forwarded-for'] ||
        req.connection.remoteAddress ||
        'unknown-client';

    const now = Date.now();
    const lastRequestTime = rateLimits.get(clientId);

    if (lastRequestTime) {
        const timeSinceLastRequest = now - lastRequestTime;

        if (timeSinceLastRequest < RATE_LIMIT_MS) {
            const waitTimeSeconds = Math.ceil(
                (RATE_LIMIT_MS - timeSinceLastRequest) / 1000
            );

            return res.status(429).json({
                error: `Rate limit exceeded. Please wait ${waitTimeSeconds} seconds before making another request.`,
                timestamp: new Date().toISOString()
            });
        }
    }

    // Update rate limit
    rateLimits.set(clientId, now);

    // Generate random emojis
    const randomEmojis = getRandomEmojis(count, emojisData.emojis);

    // Return JSON response
    return res.status(200).json({
        emojis: randomEmojis,
        emoji_string: randomEmojis.join(''),
        count: count,
        timestamp: new Date().toISOString()
    });
}
